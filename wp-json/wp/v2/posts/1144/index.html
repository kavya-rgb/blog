{"id":1144,"date":"2022-03-09T14:07:23","date_gmt":"2022-03-09T14:07:23","guid":{"rendered":"http:\/\/localhost\/wordpress\/forever-functional-shuffling-an-array-not-as-trivial-as-it-sounds\/"},"modified":"2022-03-09T14:07:23","modified_gmt":"2022-03-09T14:07:23","slug":"forever-functional-shuffling-an-array-not-as-trivial-as-it-sounds","status":"publish","type":"post","link":"http:\/\/localhost\/wordpress\/forever-functional-shuffling-an-array-not-as-trivial-as-it-sounds\/","title":{"rendered":"Forever Functional: Shuffling an Array, Not as Trivial as It Sounds"},"content":{"rendered":"<p> <br \/>\n<\/p>\n<div data-article-id=\"1017280\" id=\"article-body\">\n<p><em>by author <a href=\"https:\/\/blog.openreplay.com\/authors\/federico-kereki\/\">Federico Kereki<\/a><\/em><\/p>\n<p>Do you trust the web? (OK, that&#8217;s click bait&#8230; but let me explain my experience.) Some time ago, I got a peculiar requirement for a change in an API I had developed. Basically, the involved endpoint collected and collated information from services and databases, to produce a certain set of results. The request was that the result set had to be in random order, meaning that repeated calls to the endpoint would produce the same data (assuming the other services and databases didn&#8217;t change) but every time in a random sequence. Furthermore, it was desired that all possible shuffled sequences should be equally probable, because of some statistics-related needs. So, I already knew how to produce the data set, but I now needed to be able to put it in disorder before sending it back to the client. <\/p>\n<p>In this article we&#8217;ll see how I implemented my &#8220;un-sorting&#8221; shuffling function, and how I tested it (by applying <a href=\"https:\/\/blog.openreplay.com\/forever-functional-higher-order-functions-functions-to-rule-functions\">higher-order functions<\/a>) to be reasonably certain that I hadn&#8217;t messed up. And, to get back to my comment about trusting the web, we&#8217;ll see how the most often quoted (and widely available on the web) shuffling algorithm, is totally wrong!<\/p>\n<h2>\n  <a name=\"testing-my-shuffling-algorithm\" href=\"#testing-my-shuffling-algorithm\"><br \/>\n  <\/a><br \/>\n  Testing my Shuffling Algorithm<br \/>\n<\/h2>\n<p>How can you test a shuffling algorithm? If you apply it to a given array, you can check if the output array has the same values as the input array: that&#8217;s a basic requirement. But how do you test if it produces multiple random orderings, and with equal probabilities? (By the way, this is called a <a href=\"https:\/\/en.wikipedia.org\/wiki\/Discrete_uniform_distribution\">uniform distribution<\/a> implying that all possible results have the same uniform probability.) The real way of checking it would be applying a <a href=\"https:\/\/en.wikipedia.org\/wiki\/Goodness_of_fit#Pearson's_chi-square_test\">Chi-squared goodness of fit test<\/a>: basically, you&#8217;d have to generate many sequences and do some math to see whether the produced distribution is uniform or not. <\/p>\n<p>I <em>could<\/em> have done that, but I opted for a more empirical way of working. I decided to implement a <a href=\"https:\/\/en.wikipedia.org\/wiki\/Higher-order_function\">higher-order function<\/a> that would take a shuffling function as an input, call it a good number of times, record the results, and then produce a chart to easily see how uniform were the results. For instance, doing 24,000 runs to shuffle a 4-element array should produce something like the following.<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight plaintext\"><code>A-B-C-D:   983 ###############################################\nA-B-D-C:  1026 #################################################\nA-C-B-D:   977 ##############################################\nA-C-D-B:   993 ###############################################\nA-D-B-C:   983 ###############################################\nA-D-C-B:   984 ###############################################\nB-A-C-D:  1028 #################################################\nB-A-D-C:   986 ###############################################\nB-C-A-D:  1033 #################################################\nB-C-D-A:  1016 ################################################\nB-D-A-C:   957 ##############################################\nB-D-C-A:  1022 #################################################\nC-A-B-D:   989 ###############################################\nC-A-D-B:   962 ##############################################\nC-B-A-D:   993 ###############################################\nC-B-D-A:  1028 #################################################\nC-D-A-B:   955 #############################################\nC-D-B-A:  1004 ################################################\nD-A-B-C:  1023 #################################################\nD-A-C-B:  1051 ##################################################\nD-B-A-C:   985 ###############################################\nD-B-C-A:  1020 #################################################\nD-C-A-B:   990 ###############################################\nD-C-B-A:  1012 ################################################\nCOUNT= 24\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>There are 24 possible outputs and we did 24,000 runs, so each output should be close to the expected result, 1,000. It seems that the algorithm that produced this output is good; all counts are very similar to each other. Checking algorithms empirically was good enough for my case: I could verify that the published algorithm was quite bad (as we&#8217;ll see below) and it was useful to test that my implementations weren&#8217;t buggy.<\/p>\n<p>The following code implements the idea we&#8217;ve described: it does a given number of shuffles, records how many times each output appeared, and produces a bar chart with the results.<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight javascript\"><code><span class=\"kd\">const<\/span> <span class=\"nx\">makeBar<\/span> <span class=\"o\">=<\/span> <span class=\"p\">(<\/span><span class=\"nx\">len<\/span><span class=\"p\">,<\/span> <span class=\"nx\">val<\/span><span class=\"p\">,<\/span> <span class=\"nx\">max<\/span><span class=\"p\">)<\/span> <span class=\"o\">=&gt;<\/span> \n  <span class=\"dl\">\"<\/span><span class=\"s2\">#<\/span><span class=\"dl\">\"<\/span><span class=\"p\">.<\/span><span class=\"nx\">repeat<\/span><span class=\"p\">(<\/span><span class=\"nb\">Math<\/span><span class=\"p\">.<\/span><span class=\"nx\">round<\/span><span class=\"p\">((<\/span><span class=\"nx\">len<\/span> <span class=\"o\">*<\/span> <span class=\"nx\">val<\/span><span class=\"p\">)<\/span> <span class=\"o\">\/<\/span> <span class=\"nx\">max<\/span><span class=\"p\">));<\/span>          <span class=\"cm\">\/*  1 *\/<\/span> \n\n<span class=\"kd\">const<\/span> <span class=\"nx\">testShuffle<\/span> <span class=\"o\">=<\/span> <span class=\"p\">(<\/span><span class=\"nx\">fn<\/span><span class=\"p\">,<\/span> <span class=\"nx\">n<\/span> <span class=\"o\">=<\/span> <span class=\"mi\">5<\/span><span class=\"p\">,<\/span> <span class=\"nx\">times<\/span> <span class=\"o\">=<\/span> <span class=\"mi\">4000<\/span><span class=\"p\">)<\/span> <span class=\"o\">=&gt;<\/span> <span class=\"p\">{<\/span>    <span class=\"cm\">\/*  2 *\/<\/span>\n  <span class=\"kd\">const<\/span> <span class=\"nx\">result<\/span> <span class=\"o\">=<\/span> <span class=\"p\">{};<\/span>                                  <span class=\"cm\">\/*  3 *\/<\/span>\n  <span class=\"kd\">let<\/span> <span class=\"nx\">max<\/span> <span class=\"o\">=<\/span> <span class=\"mi\">0<\/span><span class=\"p\">;<\/span>                                        <span class=\"cm\">\/*  4 *\/<\/span>\n  <span class=\"k\">for<\/span> <span class=\"p\">(<\/span><span class=\"kd\">let<\/span> <span class=\"nx\">i<\/span> <span class=\"o\">=<\/span> <span class=\"mi\">1<\/span><span class=\"p\">;<\/span> <span class=\"nx\">i<\/span> <span class=\"o\">&lt;=<\/span> <span class=\"nx\">times<\/span><span class=\"p\">;<\/span> <span class=\"nx\">i<\/span><span class=\"o\">++<\/span><span class=\"p\">)<\/span> <span class=\"p\">{<\/span>                  <span class=\"cm\">\/*  5 *\/<\/span>\n    <span class=\"kd\">const<\/span> <span class=\"nx\">arr<\/span> <span class=\"o\">=<\/span> <span class=\"nb\">Array<\/span><span class=\"p\">(<\/span><span class=\"nx\">n<\/span><span class=\"p\">)<\/span>                              <span class=\"cm\">\/*  6 *\/<\/span>\n      <span class=\"p\">.<\/span><span class=\"nx\">fill<\/span><span class=\"p\">(<\/span><span class=\"mi\">0<\/span><span class=\"p\">)<\/span>\n      <span class=\"p\">.<\/span><span class=\"nx\">map<\/span><span class=\"p\">((<\/span><span class=\"nx\">v<\/span><span class=\"p\">,<\/span> <span class=\"nx\">i<\/span><span class=\"p\">)<\/span> <span class=\"o\">=&gt;<\/span> <span class=\"nb\">String<\/span><span class=\"p\">.<\/span><span class=\"nx\">fromCharCode<\/span><span class=\"p\">(<\/span><span class=\"mi\">65<\/span> <span class=\"o\">+<\/span> <span class=\"nx\">i<\/span><span class=\"p\">));<\/span>\n\n    <span class=\"kd\">const<\/span> <span class=\"nx\">x<\/span> <span class=\"o\">=<\/span> <span class=\"nx\">fn<\/span><span class=\"p\">(<\/span><span class=\"nx\">arr<\/span><span class=\"p\">).<\/span><span class=\"nx\">join<\/span><span class=\"p\">(<\/span><span class=\"dl\">\"<\/span><span class=\"s2\">-<\/span><span class=\"dl\">\"<\/span><span class=\"p\">);<\/span>                      <span class=\"cm\">\/*  7 *\/<\/span>\n    <span class=\"nx\">result<\/span><span class=\"p\">[<\/span><span class=\"nx\">x<\/span><span class=\"p\">]<\/span> <span class=\"o\">=<\/span> <span class=\"nx\">x<\/span> <span class=\"k\">in<\/span> <span class=\"nx\">result<\/span> <span class=\"p\">?<\/span> <span class=\"nx\">result<\/span><span class=\"p\">[<\/span><span class=\"nx\">x<\/span><span class=\"p\">]<\/span> <span class=\"o\">+<\/span> <span class=\"mi\">1<\/span> <span class=\"p\">:<\/span> <span class=\"mi\">1<\/span><span class=\"p\">;<\/span>      <span class=\"cm\">\/*  8 *\/<\/span>\n    <span class=\"nx\">max<\/span> <span class=\"o\">=<\/span> <span class=\"nb\">Math<\/span><span class=\"p\">.<\/span><span class=\"nx\">max<\/span><span class=\"p\">(<\/span><span class=\"nx\">max<\/span><span class=\"p\">,<\/span> <span class=\"nx\">result<\/span><span class=\"p\">[<\/span><span class=\"nx\">x<\/span><span class=\"p\">]);<\/span>                   <span class=\"cm\">\/*  9 *\/<\/span>\n  <span class=\"p\">}<\/span>\n\n  <span class=\"kd\">let<\/span> <span class=\"nx\">count<\/span> <span class=\"o\">=<\/span> <span class=\"mi\">0<\/span><span class=\"p\">;<\/span>                                      <span class=\"cm\">\/* 10 *\/<\/span>\n  <span class=\"k\">for<\/span> <span class=\"p\">(<\/span><span class=\"kd\">const<\/span> <span class=\"p\">[<\/span><span class=\"nx\">key<\/span><span class=\"p\">,<\/span> <span class=\"nx\">val<\/span><span class=\"p\">]<\/span> <span class=\"k\">of<\/span> <span class=\"nb\">Object<\/span><span class=\"p\">.<\/span><span class=\"nx\">entries<\/span><span class=\"p\">(<\/span><span class=\"nx\">result<\/span><span class=\"p\">).<\/span><span class=\"nx\">sort<\/span><span class=\"p\">((<\/span><span class=\"nx\">a<\/span><span class=\"p\">,<\/span> <span class=\"nx\">b<\/span><span class=\"p\">)<\/span> <span class=\"o\">=&gt;<\/span>\n    <span class=\"nx\">a<\/span> <span class=\"o\">&lt;<\/span> <span class=\"nx\">b<\/span> <span class=\"p\">?<\/span> <span class=\"o\">-<\/span><span class=\"mi\">1<\/span> <span class=\"p\">:<\/span> <span class=\"mi\">1<\/span>\n  <span class=\"p\">))<\/span> <span class=\"p\">{<\/span>\n    <span class=\"nx\">count<\/span><span class=\"o\">++<\/span><span class=\"p\">;<\/span>                                          <span class=\"cm\">\/* 11 *\/<\/span>\n    <span class=\"nx\">console<\/span><span class=\"p\">.<\/span><span class=\"nx\">log<\/span><span class=\"p\">(<\/span><span class=\"s2\">`<\/span><span class=\"p\">${<\/span><span class=\"nx\">key<\/span><span class=\"p\">}<\/span><span class=\"s2\">: <\/span><span class=\"p\">${<\/span><span class=\"nb\">String<\/span><span class=\"p\">(<\/span><span class=\"nx\">val<\/span><span class=\"p\">).<\/span><span class=\"nx\">padStart<\/span><span class=\"p\">(<\/span><span class=\"mi\">5<\/span><span class=\"p\">)}<\/span><span class=\"s2\"> <\/span><span class=\"p\">${<\/span><span class=\"nx\">makeBar<\/span><span class=\"p\">(<\/span><span class=\"mi\">50<\/span><span class=\"p\">,<\/span> <span class=\"nx\">val<\/span><span class=\"p\">,<\/span> <span class=\"nx\">max<\/span><span class=\"p\">)}<\/span><span class=\"s2\">`<\/span><span class=\"p\">);<\/span>\n  <span class=\"p\">}<\/span>\n  <span class=\"nx\">console<\/span><span class=\"p\">.<\/span><span class=\"nx\">log<\/span><span class=\"p\">(<\/span><span class=\"dl\">\"<\/span><span class=\"s2\">COUNT=<\/span><span class=\"dl\">\"<\/span><span class=\"p\">,<\/span> <span class=\"nx\">count<\/span><span class=\"p\">);<\/span>                       <span class=\"cm\">\/* 12 *\/<\/span>\n<span class=\"p\">};<\/span>\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>An auxiliary <code>makeBar()<\/code> function will be used to produce a horizontal bar [1] with which we&#8217;ll produce our chart. The <code>testShuffle()<\/code> function receives a shuffling function as a parameter, the size of the array to use for tests (defaulting to 5), and how many times to do the test [2]. An array will store the results [3]; a <a href=\"https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Map\">map<\/a> would be an alternative. The <code>max<\/code> variable [4] will track the highest count we find. We&#8217;ll do a loop [5] in which we&#8217;ll initialize an array with the first letters of the alphabet [6], we&#8217;ll shuffle it [7] and make a string (such as &#8220;B-C-A-D&#8221;) to use as a key when tracking counts [8]. After getting each new count [9] we&#8217;ll see if we have to update <code>max<\/code>. After the loop is done we&#8217;ll count how many distinct permutations were produced [10]. We&#8217;ll sort all the produced sequences alphabetically, and loop over them updating the count [11] and printing out bars. Finally, we&#8217;ll log the count [12] which is an extra check.<\/p>\n<h2>\n  <a name=\"the-really-bad-but-popular-shuffle\" href=\"#the-really-bad-but-popular-shuffle\"><br \/>\n  <\/a><br \/>\n  The really bad (but popular?) shuffle<br \/>\n<\/h2>\n<p>OK, now we have a way to check if any given shuffling array is any good or not. Let&#8217;s consider how to do the shuffle itself. The truly bad algorithm that has been making the rounds has the advantage of simplicity itself: a one-liner! What&#8217;s the idea? The key concept needs remembering how JavaScript&#8217;s own <code>.sort()<\/code> method work. To <a href=\"https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/JavaScript\/Reference\/Global_Objects\/Array\/sort\">sort an array<\/a> you have to provide a function that will compare two values and return a negative value if the first is smaller than the second, a positive value if it is greater, and zero if values are equal. The algorithm you may find at many places randomly returns a negative or positive result (instead of actually comparing values) so it&#8217;s expected that the resulting array may be in some disorder. An implementation follows.<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight javascript\"><code><span class=\"kd\">const<\/span> <span class=\"nx\">poorShuffle<\/span> <span class=\"o\">=<\/span> <span class=\"p\">(<\/span><span class=\"nx\">arr<\/span><span class=\"p\">)<\/span> <span class=\"o\">=&gt;<\/span> <span class=\"nx\">arr<\/span><span class=\"p\">.<\/span><span class=\"nx\">sort<\/span><span class=\"p\">(()<\/span> <span class=\"o\">=&gt;<\/span> <span class=\"nb\">Math<\/span><span class=\"p\">.<\/span><span class=\"nx\">random<\/span><span class=\"p\">()<\/span> <span class=\"o\">-<\/span> <span class=\"mf\">0.5<\/span><span class=\"p\">);<\/span>\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>Calculating a random number produces a result between 0 and 1; subtracting 0.5 makes a result between -0.5 and +0.5, so half of the times the comparison will go one way, and the other half of the times it will go the other way. If you were shuffling a two-element array, this would indeed work. But what happens with larger arrays? To test this, I tried doing <code>testShuffle(poorShuffle, 3, 10_000)<\/code> but got very bad results. For example, doing 10,000 experiments with three elements, the results are lopsided.<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight plaintext\"><code>A-B-C:  3777 ##################################################\nA-C-B:   632 ########\nB-A-C:  1258 #################\nB-C-A:   643 #########\nC-A-B:   605 ########\nC-B-A:  3085 #########################################\nCOUNT= 6\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>Instead of getting six similar totals, there&#8217;s a very wide variation. The lowest count is less than one-sixth of the highest count, and that doesn&#8217;t seem really random. I tried larger arrays, and the results were similar; for instance, with 4 elements I got the following.<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight plaintext\"><code>A-B-C-D:  1886 ##################################################\nA-B-D-C:   671 ##################\nA-C-B-D:   165 ####\nA-C-D-B:   150 ####\nA-D-B-C:   627 #################\nA-D-C-B:   169 ####\nB-A-C-D:   306 ########\nB-A-D-C:   320 ########\nB-C-A-D:   162 ####\nB-C-D-A:   157 ####\nB-D-A-C:   311 ########\nB-D-C-A:   149 ####\nC-A-B-D:   162 ####\nC-A-D-B:   132 ###\nC-B-A-D:   429 ###########\nC-B-D-A:   452 ############\nC-D-A-B:   156 ####\nC-D-B-A:   474 #############\nD-A-B-C:   653 #################\nD-A-C-B:   161 ####\nD-B-A-C:   338 #########\nD-B-C-A:   152 ####\nD-C-A-B:   141 ####\nD-C-B-A:  1677 ############################################\nCOUNT= 24\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>Even if all 24 possible shuffles were produced, the results are even more lopsided. The longer the array, the worse the results; with five elements the ratio between the lowest and highest counts was around 60! For sure, this algorithm, despite its simplicity, cannot be used. This was unexpected, and meant that I had to look for a better option; let&#8217;s get to that!<\/p>\n<h2>\n  <a name=\"shuffling-by-sorting\" href=\"#shuffling-by-sorting\"><br \/>\n  <\/a><br \/>\n  Shuffling by sorting<br \/>\n<\/h2>\n<p>The first algorithm I&#8217;ll describe is also based on the idea of sorting (like the popular and wrong function that we discarded!) but works on a different basis. The key concept is simple. To get a random sequence, assign to each array element a random number, sort the array by that number, and you&#8217;ll produce a totally random ordering. This can be implemented as a one-liner &#8212; though OK, a not too short one&#8230;<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight javascript\"><code><span class=\"kd\">const<\/span> <span class=\"nx\">sortingShuffle<\/span> <span class=\"o\">=<\/span> <span class=\"p\">(<\/span><span class=\"nx\">arr<\/span><span class=\"p\">)<\/span> <span class=\"o\">=&gt;<\/span>\n  <span class=\"nx\">arr<\/span>\n    <span class=\"p\">.<\/span><span class=\"nx\">map<\/span><span class=\"p\">((<\/span><span class=\"nx\">v<\/span><span class=\"p\">)<\/span> <span class=\"o\">=&gt;<\/span> <span class=\"p\">({<\/span> <span class=\"na\">val<\/span><span class=\"p\">:<\/span> <span class=\"nx\">v<\/span><span class=\"p\">,<\/span> <span class=\"na\">key<\/span><span class=\"p\">:<\/span> <span class=\"nb\">Math<\/span><span class=\"p\">.<\/span><span class=\"nx\">random<\/span><span class=\"p\">()<\/span> <span class=\"p\">}))<\/span> <span class=\"cm\">\/* 1 *\/<\/span>\n    <span class=\"p\">.<\/span><span class=\"nx\">sort<\/span><span class=\"p\">((<\/span><span class=\"nx\">a<\/span><span class=\"p\">,<\/span> <span class=\"nx\">b<\/span><span class=\"p\">)<\/span> <span class=\"o\">=&gt;<\/span> <span class=\"nx\">a<\/span><span class=\"p\">.<\/span><span class=\"nx\">key<\/span> <span class=\"o\">-<\/span> <span class=\"nx\">b<\/span><span class=\"p\">.<\/span><span class=\"nx\">key<\/span><span class=\"p\">)<\/span>                <span class=\"cm\">\/* 2 *\/<\/span>\n    <span class=\"p\">.<\/span><span class=\"nx\">map<\/span><span class=\"p\">((<\/span><span class=\"nx\">o<\/span><span class=\"p\">)<\/span> <span class=\"o\">=&gt;<\/span> <span class=\"nx\">o<\/span><span class=\"p\">.<\/span><span class=\"nx\">val<\/span><span class=\"p\">);<\/span>                           <span class=\"cm\">\/* 3 *\/<\/span>\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>Let&#8217;s see how this works. First [1] we take the array to be shuffled and produce a new array of objects with the original value at <code>val<\/code> and a random number at <code>key<\/code>. Then [2] we sort the array by comparing the key values. Finally [3] we undo the mapping by just extracting the <code>val<\/code> values. We&#8217;ve got a randomly shuffled array, with practically no code! I did some test runs, and got good results like the following, in which I shuffled a three-element array 60 thousand times! (It took about a tenth of a second at my machine.) I also tested longer arrays &#8212; but I always got good results, so I had good reasons to believe that my implementation was correct.<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight plaintext\"><code>A-B-C: 10003 #################################################\nA-C-B:  9983 #################################################\nB-A-C:  9915 #################################################\nB-C-A: 10001 #################################################\nC-A-B:  9976 #################################################\nC-B-A: 10122 ##################################################\nCOUNT= 6\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>This method is quite efficient, and for smallish arrays is probably best. For larger arrays sorting may take a bit too long, and some basic Computer Science results say that this behavior will grow worse. (For example, if you double the array size, time will more than double.) I checked the literature and found a better algorithm, whose performance is proportional to the size of the array, as you&#8217;d desire. Curiously, the way the algorithm works is somehow related to <a href=\"https:\/\/en.wikipedia.org\/wiki\/Bogosort\">Bogosort<\/a>, also known as &#8220;the worst sorting algorithm ever&#8221;! Let&#8217;s first consider this spectacularly bad sort algorithm, and then turn it into a fine shuffling one.<\/p>\n<h2>\n  <a name=\"sorting-by-chance\" href=\"#sorting-by-chance\"><br \/>\n  <\/a><br \/>\n  Sorting by chance<br \/>\n<\/h2>\n<p>If you study Computer Science, you&#8217;ll be taught several sorting methods &#8212; and each one tries to be better than the others, and perform at top speed. There exists, however, that is totally inefficient. To describe it, let&#8217;s imagine how you could shuffle a deck of cards. Bogosort does it very simply: <\/p>\n<ol>\n<li>throw the deck into the air, and let all cards fall on the floor. <\/li>\n<li>pick up the cards in any order, as randomly as you wish<\/li>\n<li>check if (by pure chance!) the cards are in order. <\/li>\n<li>If so, you&#8217;re done! <\/li>\n<li>But if not (most likely&#8230;) go back to step 1 and try again!<\/li>\n<\/ol>\n<p>This is truly bad &#8212; and I hope you won&#8217;t be tempted to try it out! However, the notion of picking elements in random order does lead to an interesting way of doing shuffling, and that&#8217;s what we&#8217;ll describe.<\/p>\n<h2>\n  <a name=\"open-source-session-replay\" href=\"#open-source-session-replay\"><br \/>\n  <\/a><br \/>\n  Open Source Session Replay<br \/>\n<\/h2>\n<p>Debugging a web application in production may be challenging and time-consuming. <a href=\"https:\/\/github.com\/openreplay\/openreplay\">OpenReplay<\/a> is an Open-source alternative to FullStory, LogRocket and Hotjar. It allows you to monitor and replay everything your users do and shows how your app behaves for every issue.<br \/>It\u2019s like having your browser\u2019s inspector open while looking over your user\u2019s shoulder.<br \/>OpenReplay is the only open-source alternative currently available.<\/p>\n<p><a href=\"https:\/\/res.cloudinary.com\/practicaldev\/image\/fetch\/s--MvoFt7Qf--\/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\/https:\/\/raw.githubusercontent.com\/openreplay\/openreplay\/main\/static\/replayer.png\" class=\"article-body-image-wrapper\"><img src=\"https:\/\/res.cloudinary.com\/practicaldev\/image\/fetch\/s--MvoFt7Qf--\/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\/https:\/\/raw.githubusercontent.com\/openreplay\/openreplay\/main\/static\/replayer.png\" alt=\"OpenReplay\" loading=\"lazy\" width=\"880\" height=\"497\"\/><\/a><\/p>\n<p>Happy debugging, for modern frontend teams &#8211; <a href=\"https:\/\/github.com\/openreplay\/openreplay\">Start monitoring your web app for free<\/a>.<\/p>\n<h2>\n  <a name=\"fisheryates-shuffling-method\" href=\"#fisheryates-shuffling-method\"><br \/>\n  <\/a><br \/>\n  Fisher-Yates shuffling method<br \/>\n<\/h2>\n<p>The Fisher-Yates method is a perfect (albeit a bit too complex to do by hand&#8230;) way of shuffling a deck of cards. How does it work? Basically, pick the whole deck. While there are cards left in it, randomly pick any card, put it away, and repeat. When the deck is exhausted, you&#8217;ll have put away the cards in a totally random way. As we are shuffling an array, we can do better, by not even requiring an extra array. To shuffle an array of N elements, we may simply do:<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight plaintext\"><code>for I starting at N-1, going down to 1:\n  let J be a random number between 0 and I inclusive\n  exchange the elements at positions I and J\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>We need a function that given a number K will generate a number between 0 and K itself. We can manage that by using <code>Math.random()<\/code> and <code>Math.floor()<\/code> as follows.<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight javascript\"><code><span class=\"kd\">const<\/span> <span class=\"nx\">randomInt<\/span> <span class=\"o\">=<\/span> <span class=\"p\">(<\/span><span class=\"nx\">k<\/span><span class=\"p\">)<\/span> <span class=\"o\">=&gt;<\/span> <span class=\"nb\">Math<\/span><span class=\"p\">.<\/span><span class=\"nx\">floor<\/span><span class=\"p\">((<\/span><span class=\"nx\">k<\/span> <span class=\"o\">+<\/span> <span class=\"mi\">1<\/span><span class=\"p\">)<\/span> <span class=\"o\">*<\/span> <span class=\"nb\">Math<\/span><span class=\"p\">.<\/span><span class=\"nx\">random<\/span><span class=\"p\">());<\/span>\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>Why does this work? First, remember that <code>Math.random()<\/code> produces a number greater than or equal to zero, but less than 1. If you multiply this by (K+1) the result is greater than or equal to zero, but less than (K+1). If you take the integer part of it with <code>Math.floor()<\/code> you&#8217;re left with an integer number greater than or equal to zero, and less than (K+1) &#8212; that is to say, less than or equal to K, as desired. With this function, we can complete our shuffling code.<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight javascript\"><code><span class=\"kd\">const<\/span> <span class=\"nx\">fisherYatesShuffle<\/span> <span class=\"o\">=<\/span> <span class=\"p\">(<\/span><span class=\"nx\">arr<\/span><span class=\"p\">)<\/span> <span class=\"o\">=&gt;<\/span> <span class=\"p\">{<\/span>\n  <span class=\"k\">for<\/span> <span class=\"p\">(<\/span><span class=\"kd\">let<\/span> <span class=\"nx\">i<\/span> <span class=\"o\">=<\/span> <span class=\"nx\">arr<\/span><span class=\"p\">.<\/span><span class=\"nx\">length<\/span> <span class=\"o\">-<\/span> <span class=\"mi\">1<\/span><span class=\"p\">;<\/span> <span class=\"nx\">i<\/span> <span class=\"o\">&gt;<\/span> <span class=\"mi\">0<\/span><span class=\"p\">;<\/span> <span class=\"nx\">i<\/span><span class=\"o\">--<\/span><span class=\"p\">)<\/span> <span class=\"p\">{<\/span>\n    <span class=\"kd\">const<\/span> <span class=\"nx\">j<\/span> <span class=\"o\">=<\/span> <span class=\"nx\">randomInt<\/span><span class=\"p\">(<\/span><span class=\"nx\">i<\/span><span class=\"p\">);<\/span>\n    <span class=\"p\">[<\/span><span class=\"nx\">arr<\/span><span class=\"p\">[<\/span><span class=\"nx\">i<\/span><span class=\"p\">],<\/span> <span class=\"nx\">arr<\/span><span class=\"p\">[<\/span><span class=\"nx\">j<\/span><span class=\"p\">]]<\/span> <span class=\"o\">=<\/span> <span class=\"p\">[<\/span><span class=\"nx\">arr<\/span><span class=\"p\">[<\/span><span class=\"nx\">j<\/span><span class=\"p\">],<\/span> <span class=\"nx\">arr<\/span><span class=\"p\">[<\/span><span class=\"nx\">i<\/span><span class=\"p\">]];<\/span>\n  <span class=\"p\">}<\/span>\n  <span class=\"k\">return<\/span> <span class=\"nx\">arr<\/span><span class=\"p\">;<\/span>\n<span class=\"p\">};<\/span>\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>The function works as described above, and produces uniform random shuffles. A sample run with our testing function from the previous article shows its good behavior.<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight plaintext\"><code>A-B-C-D:  1028 ################################################\nA-B-D-C:  1005 ###############################################\nA-C-B-D:   946 ############################################\nA-C-D-B:  1017 ################################################\nA-D-B-C:   988 ##############################################\nA-D-C-B:  1049 #################################################\nB-A-C-D:  1013 ################################################\nB-A-D-C:   952 #############################################\nB-C-A-D:  1043 #################################################\nB-C-D-A:   935 ############################################\nB-D-A-C:  1066 ##################################################\nB-D-C-A:  1041 #################################################\nC-A-B-D:   940 ############################################\nC-A-D-B:  1007 ###############################################\nC-B-A-D:   982 ##############################################\nC-B-D-A:  1029 ################################################\nC-D-A-B:   994 ###############################################\nC-D-B-A:   992 ###############################################\nD-A-B-C:   972 ##############################################\nD-A-C-B:  1004 ###############################################\nD-B-A-C:   995 ###############################################\nD-B-C-A:   971 ##############################################\nD-C-A-B:   986 ##############################################\nD-C-B-A:  1045 #################################################\nCOUNT= 24\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>We&#8217;re done! If you have to process larger arrays and the sorting-based shuffling algorithm takes too long, the Fisher-Yates algorithm will do better.<\/p>\n<h2>\n  <a name=\"summary\" href=\"#summary\"><br \/>\n  <\/a><br \/>\n  Summary<br \/>\n<\/h2>\n<p>In this article, we&#8217;ve seen a special requirement I got, which implied sorting the output of a service call in a random way, and we discussed how to test any possible algorithm, and ended by applying our analysis to a very commonly mentioned shuffling algorithm &#8212; which proved to be quite bad! We also considered a pair of shuffling algorithms:<\/p>\n<ul>\n<li>The first one had the plus of being extra-simple and short but could behave not so well for longish arrays. <\/li>\n<li>The second algorithm was a tad more complex, but its performance was guaranteed to be good. <\/li>\n<\/ul>\n<p>While there are more algorithms to shuffle data, these were enough for my requirements (I started by using the sorting shuffling algorithm, but then changed to Fisher-Yates to be safe in case an API result got very big). Server-side coding doesn&#8217;t usually make you get involved with this kind of problem, so the requirement that my users gave me was quite interesting. <\/p>\n<p>And, it also provided a reminder to not blindly trust code you can pull out of the web &#8212; &#8220;you get what you pay for&#8221; also applies to code!<\/p>\n<\/p><\/div>\n\n","protected":false},"excerpt":{"rendered":"<p>by author Federico Kereki Do you trust the web? (OK, that&#8217;s click bait&#8230; but let me explain my experience.) Some time ago, I got a peculiar requirement for a change in an API I had developed. Basically, the involved endpoint collected and collated information from services and databases, to produce a certain set of results. &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"\" href=\"http:\/\/localhost\/wordpress\/forever-functional-shuffling-an-array-not-as-trivial-as-it-sounds\/\"> <span class=\"screen-reader-text\">Forever Functional: Shuffling an Array, Not as Trivial as It Sounds<\/span> Read More &raquo;<\/a><\/p>\n","protected":false},"author":1,"featured_media":1145,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":""},"categories":[1],"tags":[],"_links":{"self":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts\/1144"}],"collection":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/comments?post=1144"}],"version-history":[{"count":0,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts\/1144\/revisions"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/media\/1145"}],"wp:attachment":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/media?parent=1144"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/categories?post=1144"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/tags?post=1144"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}