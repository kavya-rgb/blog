{"id":1310,"date":"2022-03-09T17:39:30","date_gmt":"2022-03-09T17:39:30","guid":{"rendered":"http:\/\/localhost\/wordpress\/javascript-fetch-using-post-gives-error-post-object-expects-content-type-multipart-form-data-even-though-content-type-text-plaincharsetutf-8-is-specified-in-parameters\/"},"modified":"2022-03-09T17:39:30","modified_gmt":"2022-03-09T17:39:30","slug":"javascript-fetch-using-post-gives-error-post-object-expects-content-type-multipart-form-data-even-though-content-type-text-plaincharsetutf-8-is-specified-in-parameters","status":"publish","type":"post","link":"http:\/\/localhost\/wordpress\/javascript-fetch-using-post-gives-error-post-object-expects-content-type-multipart-form-data-even-though-content-type-text-plaincharsetutf-8-is-specified-in-parameters\/","title":{"rendered":"JavaScript fetch() using POST gives error &#8220;POST object expects Content-Type multipart\/form-data&#8221; even though &#8216;Content-Type&#8217;: &#8216;text\/plain;charset=utf-8&#8217; is specified in parameters"},"content":{"rendered":"\n<p>Here&#8217;s my code:<\/p>\n<p>    &lt;script type=&#8221;text\/javascript&#8221;&gt;<br \/>\n        async function replaceHTML(filename){<br \/>\n            var replace = await fetch(&#8220;HTML\/&#8221; + filename, {<br \/>\n                method:&#8217;POST&#8217;, headers: {&#8216;Content-Type&#8217;: &#8216;text\/plain;charset=utf-8&#8242;}, body:&#8217;string&#8217;}).<br \/>\n                    then(response =&gt; response.text()).<br \/>\n                    then(data =&gt; document.getElementsByClassName(&#8220;content&#8221;)[0].innerHTML = data).<br \/>\n                    catch(err =&gt; console.log(&#8216;error: &#8216; + err));<br \/>\n                    return replace;<br \/>\n                }<\/p>\n<p>                $(&#8216;#Donate&#8217;).click(function(){<br \/>\n                    replaceHTML(&#8220;Donate.html&#8221;);<br \/>\n                    return false;<br \/>\n                });<br \/>\n    &lt;\/script&gt;<\/p>\n<p>and here&#8217;s the HTML snippet &#8220;Donate.html&#8221;<\/p>\n<p>    &lt;div class=&#8221;donations&#8221;&gt;<br \/>\n        &lt;ul&gt;<br \/>\n            &lt;li&gt;<br \/>\n                &lt;a href=&#8221;https:\/\/www.state.gov\/united-with-ukraine\/&#8221;&gt;State Dept: United With Ukraine&lt;\/a&gt; &lt;br \/&gt; &lt;a href=&#8221;https:\/\/www.gofundme.com\/f\/ukraine-humanitarian-fund&#8221;&gt;Ukraine Humanitarian Fund&lt;\/a&gt;<br \/>\n            &lt;\/li&gt;<br \/>\n            &lt;li&gt;<br \/>\n                &lt;a href=&#8221;https:\/\/my.care.org\/site\/Donation2?df_id=31067&amp;mfc_pref=T&amp;31067.donation=form1&amp;s_src=172223UCF000&amp;_ga=2.135172726.651260027.1646165065-461925101.1646165065&#8243;&gt;Care&lt;\/a&gt;<br \/>\n            &lt;\/li&gt;<br \/>\n            &lt;li&gt;<br \/>\n                &lt;a href=&#8221;https:\/\/secure.projecthope.org\/site\/SPageNavigator\/2022_02_Ukraine_Response_Web_UNR.html&amp;s_subsrc=bt1&#8243;&gt;Project Hope&lt;\/a&gt;<br \/>\n            &lt;\/li&gt;<br \/>\n            &lt;li&gt;<br \/>\n                &lt;a href=&#8221;https:\/\/razomforukraine.org\/&#8221;&gt;Razom for Ukraine&lt;\/a&gt;<br \/>\n            &lt;\/li&gt;<br \/>\n            &lt;li&gt;<br \/>\n                &lt;a href=&#8221;https:\/\/www.unicef.org\/emergencies\/conflict-ukraine-pose-immediate-threat-children?utm_source=twitter&amp;utm_medium=organic-en&amp;utm_content=ukraine_crisis&amp;utm_campaign=ukraine_crisis&#8221;&gt;UNICEF&lt;\/a&gt;<br \/>\n            &lt;\/li&gt;<br \/>\n            &lt;li&gt;<br \/>\n                &lt;a href=&#8221;https:\/\/www.unitedway.org\/our-impact\/work\/no-nav\/unitedforukraine\/&#8221;&gt;United Way&lt;\/a&gt;<br \/>\n            &lt;\/li&gt;<br \/>\n            &lt;li&gt;<br \/>\n                &lt;a href=&#8221;https:\/\/voices.org.ua\/en\/&#8221;&gt;Voices of Children&lt;\/a&gt;<br \/>\n            &lt;\/li&gt;<br \/>\n            &lt;li&gt;<br \/>\n                &lt;a href=&#8221;https:\/\/wck.org\/&#8221;&gt;World Central Kitchen&lt;\/a&gt;<br \/>\n            &lt;\/li&gt;<br \/>\n            &lt;li&gt;<br \/>\n                &lt;a href=&#8221;https:\/\/donate.redcrossredcrescent.org\/ua\/donate\/~my-donation?_cv=1&#8243;&gt;Red Cross&lt;\/a&gt;<br \/>\n            &lt;\/li&gt;<br \/>\n            &lt;li&gt;<br \/>\n                &lt;a href=&#8221;https:\/\/www.globalgiving.org\/projects\/ukraine-crisis-relief-fund\/&#8221;&gt;GlobalGiving&lt;\/a&gt;<br \/>\n            &lt;\/li&gt;<br \/>\n            &lt;li&gt;<br \/>\n                &lt;a href=&#8221;https:\/\/vostok-sos.org\/en\/ukraine-under-fire-support-vostok-sos-aid-operation\/&#8221;&gt;Vostok SOS&lt;\/a&gt;<br \/>\n            &lt;\/li&gt;<br \/>\n            &lt;li&gt;<br \/>\n                &lt;a href=&#8221;https:\/\/www.gofundme.com\/f\/keep-ukraines-media-going?fbclid=IwAR2jWrF8nx344X94zBesGMlM1pMEPbV8vMv1N5Dvg5-WGQXcdBzA8QDDGF0&#8243;&gt;media support&lt;\/a&gt;<br \/>\n            &lt;\/li&gt;<br \/>\n        &lt;\/ul&gt;<br \/>\n    &lt;\/div&gt;<\/p>\n<p>nothing special about that.<\/p>\n<p>&amp;#x200B;<\/p>\n<p>The onClick works, the element is extracted correctly and on localhost (laragon\/www) it works fine. The error occurs when I upload my files to a Google Cloud server instance (buckets, I guess they&#8217;re called). Is this something uniquely wrong with Google Cloud?<\/p>\n\n","protected":false},"excerpt":{"rendered":"<p>Here&#8217;s my code: &lt;script type=&#8221;text\/javascript&#8221;&gt; async function replaceHTML(filename){ var replace = await fetch(&#8220;HTML\/&#8221; + filename, { method:&#8217;POST&#8217;, headers: {&#8216;Content-Type&#8217;: &#8216;text\/plain;charset=utf-8&#8242;}, body:&#8217;string&#8217;}). then(response =&gt; response.text()). then(data =&gt; document.getElementsByClassName(&#8220;content&#8221;)[0].innerHTML = data). catch(err =&gt; console.log(&#8216;error: &#8216; + err)); return replace; } $(&#8216;#Donate&#8217;).click(function(){ replaceHTML(&#8220;Donate.html&#8221;); return false; }); &lt;\/script&gt; and here&#8217;s the HTML snippet &#8220;Donate.html&#8221; &lt;div class=&#8221;donations&#8221;&gt; &lt;ul&gt; &lt;li&gt; &lt;a &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"\" href=\"http:\/\/localhost\/wordpress\/javascript-fetch-using-post-gives-error-post-object-expects-content-type-multipart-form-data-even-though-content-type-text-plaincharsetutf-8-is-specified-in-parameters\/\"> <span class=\"screen-reader-text\">JavaScript fetch() using POST gives error &#8220;POST object expects Content-Type multipart\/form-data&#8221; even though &#8216;Content-Type&#8217;: &#8216;text\/plain;charset=utf-8&#8217; is specified in parameters<\/span> Read More &raquo;<\/a><\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":""},"categories":[1],"tags":[],"_links":{"self":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts\/1310"}],"collection":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/comments?post=1310"}],"version-history":[{"count":0,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts\/1310\/revisions"}],"wp:attachment":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/media?parent=1310"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/categories?post=1310"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/tags?post=1310"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}