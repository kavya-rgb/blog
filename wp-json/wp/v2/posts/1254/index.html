{"id":1254,"date":"2022-03-09T17:34:47","date_gmt":"2022-03-09T17:34:47","guid":{"rendered":"http:\/\/localhost\/wordpress\/building-the-back-end-for-architecture-for-sending-an-email-invoice-after-purchasing-a-product-from-an-online-store-using-a-mail-service-like-mail-chimp-or-mail-gun\/"},"modified":"2022-03-09T17:34:47","modified_gmt":"2022-03-09T17:34:47","slug":"building-the-back-end-for-architecture-for-sending-an-email-invoice-after-purchasing-a-product-from-an-online-store-using-a-mail-service-like-mail-chimp-or-mail-gun","status":"publish","type":"post","link":"http:\/\/localhost\/wordpress\/building-the-back-end-for-architecture-for-sending-an-email-invoice-after-purchasing-a-product-from-an-online-store-using-a-mail-service-like-mail-chimp-or-mail-gun\/","title":{"rendered":"Building the back end for architecture for sending an email invoice after purchasing a product from an online store using a mail service like mail chimp or mail gun."},"content":{"rendered":"\n<p>From what I&#8217;ve gathered on the internet, the flow would go something like this:<\/p>\n<p>1) Customer orders with POST request to &#8220;web server&#8221; with req body <\/p>\n<p>`{api_key, userId, products: [{product1:{id:1, qty:2}, product2: {id:2, qty:2},&#8230;}], discount: disc1, }`<\/p>\n<p>2) &#8220;Web server&#8221; sends a request to order service<\/p>\n<p>3) &#8220;order service&#8221; writes order to a SQL database<\/p>\n<p>4) if the order is successfully written to database then publish the order to a messaging queue like Kafka. if it fails send back 400 message of failure<\/p>\n<p>5) have another service called &#8220;email writer&#8221; which subscribes from the messaging queue. <\/p>\n<p>5) a) using the user_id from the invoice, query the users database to get the name of the customer. then using the product id from the invoice, query the names and image urls for the products.<\/p>\n<p>5) b) &#8220;email writer&#8221; then calls the mail chimp API with the data acquired from 5.a)<\/p>\n<p>6) user gets an email for invoice receipt <\/p>\n<p>How does this sound? Is there anything you would change or improve on to make it more resilient? Am I right in step 4) publishing the order right after a successful write or should that be split up?<\/p>\n\n","protected":false},"excerpt":{"rendered":"<p>From what I&#8217;ve gathered on the internet, the flow would go something like this: 1) Customer orders with POST request to &#8220;web server&#8221; with req body `{api_key, userId, products: [{product1:{id:1, qty:2}, product2: {id:2, qty:2},&#8230;}], discount: disc1, }` 2) &#8220;Web server&#8221; sends a request to order service 3) &#8220;order service&#8221; writes order to a SQL database &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"\" href=\"http:\/\/localhost\/wordpress\/building-the-back-end-for-architecture-for-sending-an-email-invoice-after-purchasing-a-product-from-an-online-store-using-a-mail-service-like-mail-chimp-or-mail-gun\/\"> <span class=\"screen-reader-text\">Building the back end for architecture for sending an email invoice after purchasing a product from an online store using a mail service like mail chimp or mail gun.<\/span> Read More &raquo;<\/a><\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":""},"categories":[1],"tags":[],"_links":{"self":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts\/1254"}],"collection":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/comments?post=1254"}],"version-history":[{"count":0,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts\/1254\/revisions"}],"wp:attachment":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/media?parent=1254"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/categories?post=1254"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/tags?post=1254"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}