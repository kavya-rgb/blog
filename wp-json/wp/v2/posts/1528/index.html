{"id":1528,"date":"2022-03-10T07:16:25","date_gmt":"2022-03-10T07:16:25","guid":{"rendered":"http:\/\/localhost\/wordpress\/cypress-dotenv-como-utilizar-arquivos-env-em-seus-testes-automatizados\/"},"modified":"2022-03-10T07:16:25","modified_gmt":"2022-03-10T07:16:25","slug":"cypress-dotenv-como-utilizar-arquivos-env-em-seus-testes-automatizados","status":"publish","type":"post","link":"http:\/\/localhost\/wordpress\/cypress-dotenv-como-utilizar-arquivos-env-em-seus-testes-automatizados\/","title":{"rendered":"Cypress + dotenv: Como utilizar arquivos .env em seus testes automatizados"},"content":{"rendered":"<p> <br \/>\n<\/p>\n<div data-article-id=\"1016639\" id=\"article-body\">\n<p>Continuando a divulgar pra voc\u00eas minhas descobertas com cypress \ud83d\udc69\ud83c\udffb\u200d\ud83c\udfeb , hoje vim falar sobre como podemos utilizar o pacote dotenv para armazenar vari\u00e1veis de ambiente de maneira simples e usa-las em testes automatizados no cypress.<\/p>\n<p>Caso voc\u00ea trabalhe ou j\u00e1 trabalhou com mais de um ambiente de desenvolvimento, sabe o qu\u00e3o importante \u00e9 ter algum arquivo de configura\u00e7\u00f5es. Para testes automatizados \u00e9 a mesma coisa, as v\u00e1riaveis de ambiente nos permite reproduzir testes em diferentes ambientes, sem precisar mudar os testes em si, apenas ajustando as configura\u00e7\u00f5es necess\u00e1rias. <\/p>\n<p>O Cypress atualmente nos da diversas op\u00e7\u00f5es de como criarmos e utilizarmos essas v\u00e1riaveis de ambiente, por\u00e9m, neste pequeno tutorial iremos focar no uso do pacote <a href=\"https:\/\/github.com\/motdotla\/dotenv#readme\">dotenv<\/a>. <\/p>\n<hr\/>\n<h2>\n  <a name=\"o-pacote-dotenv\" href=\"#o-pacote-dotenv\"><br \/>\n  <\/a><br \/>\n  O pacote dotenv<br \/>\n<\/h2>\n<p>Basicamente, o dotenv \u00e9 um modulo que carrega as v\u00e1riaveis de ambiente de um arquivo .env para algum processo em execu\u00e7\u00e3o. Para instalar voc\u00ea pode usar o pacote npm:<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight plaintext\"><code>npm install dotenv --save\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>Ou yarn:<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight plaintext\"><code>yarn add dotenv\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>Ap\u00f3s instalar o pacote, basta criar um arquivo <code>.env<\/code> (necessariamente apenas .env, caso voc\u00ea coloque outro nome pode ocorrer erros), para modo de exemplo, ser\u00e1 utilizado o projeto que realiza os testes da API de CEPs (<a href=\"https:\/\/dev.to\/m4rri4nne\/testes-de-apis-com-cypress-criando-comandos-personalizados-3m7p\">Voc\u00ea pode ler aqui<\/a>).<\/p>\n<p><a href=\"https:\/\/res.cloudinary.com\/practicaldev\/image\/fetch\/s--vMxbS7nM--\/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\/https:\/\/dev-to-uploads.s3.amazonaws.com\/uploads\/articles\/jdh8g6dtvpfi8g2a8xoe.png\" class=\"article-body-image-wrapper\"><img src=\"https:\/\/res.cloudinary.com\/practicaldev\/image\/fetch\/s--vMxbS7nM--\/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\/https:\/\/dev-to-uploads.s3.amazonaws.com\/uploads\/articles\/jdh8g6dtvpfi8g2a8xoe.png\" alt=\"Cria\u00e7\u00e3o do arquivo .env\" loading=\"lazy\" width=\"296\" height=\"288\"\/><\/a> <\/p>\n<p>Tendo em vista que \u00e9 um projeto simples, por enquanto iremos armazenar em nosso arquivo .env apenas a nossa url base:<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight plaintext\"><code>BASE_URL = \"https:\/\/viacep.com.br\/ws\/\"\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<h2>\n  <a name=\"utilizando-a-v%C3%A1riavel-de-ambiente-nos-testes\" href=\"#utilizando-a-v%C3%A1riavel-de-ambiente-nos-testes\"><br \/>\n  <\/a><br \/>\n  Utilizando a v\u00e1riavel de ambiente nos testes<br \/>\n<\/h2>\n<p>Agora que j\u00e1 temos nosso arquivo pronto, precisamos acessa-lo e pegarmos essa vari\u00e1vel. Para o cypress compreender que estamos armazenando nossas vari\u00e1veis de ambiente em um arquivo <code>.env<\/code>, precisamos sinalizar isto dentro do nosso arquivo de plugins, pois como \u00e9 um pacote externo, o cypress o entende como um plugin. <\/p>\n<p>Ent\u00e3o, dentro de <code>plugins\/index.js<\/code> vamos come\u00e7ar exportando o dotenv:<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight plaintext\"><code>require('dotenv').config()\n\nmodule.exports = (on, config) =&gt; {\n\n}\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>Ap\u00f3s fazermos isto, vamos tornar as vari\u00e1veis do nosso arquivo .env dispon\u00edveis pra testes as copiando para dentro do arquivo de configura\u00e7\u00e3o <code>config.env<\/code> do proprio cypress. Para isto, basta fazermos o seguinte:<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight plaintext\"><code>require('dotenv').config()\n\nmodule.exports = (on, config) =&gt; {\n      config.env.baseurl= process.env.BASE_URL\n      return config\n}\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>Depois de realizar a configura\u00e7\u00e3o, j\u00e1 \u00e9 possivel ver que sua variavel de ambiente j\u00e1 aparece nas configura\u00e7\u00f5es do cypress quando voc\u00ea executa o comando npx cypress open e vai em Settings -&gt; Configuration:<\/p>\n<p><a href=\"https:\/\/res.cloudinary.com\/practicaldev\/image\/fetch\/s--Qnqo-L0b--\/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\/https:\/\/dev-to-uploads.s3.amazonaws.com\/uploads\/articles\/6uxu1wggyuvk5htyxbed.png\" class=\"article-body-image-wrapper\"><img src=\"https:\/\/res.cloudinary.com\/practicaldev\/image\/fetch\/s--Qnqo-L0b--\/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\/https:\/\/dev-to-uploads.s3.amazonaws.com\/uploads\/articles\/6uxu1wggyuvk5htyxbed.png\" alt=\"Cria\u00e7\u00e3o da nova variavel\" loading=\"lazy\" width=\"393\" height=\"43\"\/><\/a><\/p>\n<p>Precisamos retornar o config para o cypress entender que o objeto de configura\u00e7\u00e3o foi alterado. <\/p>\n<p>Alterando em nosso comando, onde esta vari\u00e1vel \u00e9 utilizada, vamos utilizar o comando <a href=\"https:\/\/docs.cypress.io\/api\/cypress-api\/env\">Cypress.env()<\/a>:<\/p>\n<div class=\"highlight js-code-highlight\">\n<pre class=\"highlight plaintext\"><code>\nCypress.Commands.add('GetMethod', (cep)=&gt;{\n    cy.request({\n        method: 'GET',\n        url: `${Cypress.env('baseurl') + cep}\/json`,\n        failOnStatusCode: false\n    })\n})\n<\/code><\/pre>\n<div class=\"highlight__panel js-actions-panel\">\n<div class=\"highlight__panel-action js-fullscreen-code-action\">\n    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-on\"><title>Enter fullscreen mode<\/title>\n    <path d=\"M16 3h6v6h-2V5h-4V3zM2 3h6v2H4v4H2V3zm18 16v-4h2v6h-6v-2h4zM4 19h4v2H2v-6h2v4z\"\/>\n<\/svg><\/p>\n<p>    <svg xmlns=\"http:\/\/www.w3.org\/2000\/svg\" width=\"20px\" height=\"20px\" viewbox=\"0 0 24 24\" class=\"highlight-action crayons-icon highlight-action--fullscreen-off\"><title>Exit fullscreen mode<\/title>\n    <path d=\"M18 7h4v2h-6V3h2v4zM8 9H2V7h4V3h2v6zm10 8v4h-2v-6h6v2h-4zM8 15v6H6v-4H2v-2h6z\"\/>\n<\/svg><\/p>\n<\/div>\n<\/div>\n<\/div>\n<p>E ao executarmos novamente os testes vamos ver que continuam rodando com sucesso:<\/p>\n<p><a href=\"https:\/\/res.cloudinary.com\/practicaldev\/image\/fetch\/s--BtPWVMEh--\/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\/https:\/\/dev-to-uploads.s3.amazonaws.com\/uploads\/articles\/b02qd3v0m94lhqimqzfl.png\" class=\"article-body-image-wrapper\"><img src=\"https:\/\/res.cloudinary.com\/practicaldev\/image\/fetch\/s--BtPWVMEh--\/c_limit%2Cf_auto%2Cfl_progressive%2Cq_auto%2Cw_880\/https:\/\/dev-to-uploads.s3.amazonaws.com\/uploads\/articles\/b02qd3v0m94lhqimqzfl.png\" alt=\"Execu\u00e7\u00e3o dos testes\" loading=\"lazy\" width=\"880\" height=\"777\"\/><\/a><\/p>\n<p>A utiliza\u00e7\u00e3o de arquivos .env para o amarzenamento de vari\u00e1veis nos permite ter mais flexibilidade no momento de configura-las e ter um grande volume das mesmas, acessando de maneira simples.<\/p>\n<p>Para mais formas de configurar suas vari\u00e1veis de ambiente, basta acessar a documenta\u00e7\u00e3o do <a href=\"https:\/\/docs.cypress.io\/guides\/guides\/environment-variables#Option-1-configuration-file\">cypress<\/a>, o c\u00f3digo deste tutorial est\u00e1 dispon\u00edvel <a href=\"https:\/\/github.com\/aliciamarianne1507\/cypress-api\">aqui<\/a> e at\u00e9 a proxima \ud83c\udfc3\ud83c\udffb\u200d\u2640\ufe0f<\/p>\n<\/p><\/div>\n\n","protected":false},"excerpt":{"rendered":"<p>Continuando a divulgar pra voc\u00eas minhas descobertas com cypress \ud83d\udc69\ud83c\udffb\u200d\ud83c\udfeb , hoje vim falar sobre como podemos utilizar o pacote dotenv para armazenar vari\u00e1veis de ambiente de maneira simples e usa-las em testes automatizados no cypress. Caso voc\u00ea trabalhe ou j\u00e1 trabalhou com mais de um ambiente de desenvolvimento, sabe o qu\u00e3o importante \u00e9 ter &hellip;<\/p>\n<p class=\"read-more\"> <a class=\"\" href=\"http:\/\/localhost\/wordpress\/cypress-dotenv-como-utilizar-arquivos-env-em-seus-testes-automatizados\/\"> <span class=\"screen-reader-text\">Cypress + dotenv: Como utilizar arquivos .env em seus testes automatizados<\/span> Read More &raquo;<\/a><\/p>\n","protected":false},"author":1,"featured_media":1529,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"site-sidebar-layout":"default","site-content-layout":"default","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":""},"categories":[1],"tags":[],"_links":{"self":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts\/1528"}],"collection":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/comments?post=1528"}],"version-history":[{"count":0,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts\/1528\/revisions"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/media\/1529"}],"wp:attachment":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/media?parent=1528"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/categories?post=1528"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/tags?post=1528"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}